<div style="margin: 20px; text-align: center;">
    <button onclick="confirmClearSheet()" class="admin-reset-btn">
        <i class="fas fa-database"></i> BACKUP & RESET TODAY'S DATA
    </button>
</div>

<style>
.admin-reset-btn {
    background: #dc2626;
    color: white;
    border: none;
    padding: 15px 25px;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    width: 100%;
    max-width: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.admin-reset-btn:active { transform: scale(0.98); }
</style>

<script>
// നാം നേരത്തെ സെറ്റ് ചെയ്ത അതേ WEB_APP URL ഇവിടെ നൽകുക
const WEB_APP = "https://script.google.com/macros/s/AKfycby_NZ1iI5a_uSK58ZjZyd3H8MPLpozwcR0CwiRBaRfrXzEoEPgnq2pFc-_2rU_WlyuCZg/exec";

async function confirmClearSheet() {
    const msg = "⚠️ ശ്രദ്ധിക്കുക:\n\nഇത് ഷീറ്റിന്റെ ബാക്കപ്പ് എടുക്കുകയും ഇന്നത്തെ എൻട്രികൾ (F, G, H, J, K) ക്ലിയർ ചെയ്യുകയും ചെയ്യും. ഇത് ഉറപ്പാണോ?";
    
    if (confirm(msg)) {
        const btn = document.querySelector('.admin-reset-btn');
        const originalContent = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> PROCESSING...';
        btn.style.opacity = "0.7";
        btn.disabled = true;

        try {
            await fetch(WEB_APP, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({ action: 'backup_and_clear' })
            });
            alert("✅ വിജയകരം! ബാക്കപ്പ് എടുക്കുകയും ഷീറ്റ് റീസെറ്റ് ചെയ്യുകയും ചെയ്തു.");
        } catch (e) {
            alert("❌ പരാജയപ്പെട്ടു! ഇന്റർനെറ്റ് കണക്ഷൻ പരിശോധിക്കുക.");
        } finally {
            btn.innerHTML = originalContent;
            btn.style.opacity = "1";
            btn.disabled = false;
        }
    }
}
</script>
